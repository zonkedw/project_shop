/**
 * –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API
 * 
 * –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –ü–ö/—ç–º—É–ª—è—Ç–æ—Ä–µ: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ localhost
 * –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏: –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
 * 
 * –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è EXPO_PUBLIC_API_URL
 * –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∏–∂–µ
 */

import Constants from 'expo-constants';

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º API URL
const getApiUrl = () => {
  // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è (–¥–ª—è Expo)
  if (Constants.expoConfig?.extra?.apiUrl) {
    return Constants.expoConfig.extra.apiUrl;
  }
  
  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (–¥–ª—è web/dev)
  if (typeof process !== 'undefined' && process.env?.EXPO_PUBLIC_API_URL) {
    return process.env.EXPO_PUBLIC_API_URL;
  }
  
  // 3. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
  if (Constants.platform?.ios || Constants.platform?.android) {
    // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º IP –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é localhost (–¥–ª—è —ç–º—É–ª—è—Ç–æ—Ä–∞/—Å–∏–º—É–ª—è—Ç–æ—Ä–∞)
    // –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ –ü–ö
    return 'http://localhost:3000/api';
  }
  
  // 4. –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  return 'http://localhost:3000/api';
};

export const API_URL = getApiUrl();

// –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π URL (—Ç–æ–ª—å–∫–æ –≤ dev)
if (__DEV__) {
  console.log('üì° API URL:', API_URL);
}

